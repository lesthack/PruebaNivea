{% extends "base_site.html" %}

{% block title %}Evaluaciones{% endblock %}
{% block title_page %}{{ evaluacion.nombre_persona }}{% endblock %}

{% block content %}
<div class="panel panel-default">
  <div class="panel-heading">Datos Generales</div>
  <div class="panel-body">
    <div class="table-responsive table-bordered">
      <table class="table">
        <tbody>
          <tr>
            <td width="150px"><b>ID</b></td>
            <td>{{ evaluacion.id }}</td>
          </tr>
          <tr>
            <td>Fecha</td>
            <td>{{ evaluacion.fecha }}</td>
          </tr>
          <tr>
            <td>Sexo</td>
            <td>{{ evaluacion.get_sexo }}</td>
          </tr>
          <tr>
            <td>Edad</td>
            <td>{{ evaluacion.edad }} años</td>
          </tr>
          <tr>
            <td>Estado Civíl</td>
            <td>{{ evaluacion.get_estado_civil }}</td>
          </tr>
          <tr>
            <td>Escolaridad</td>
            <td>{{ evaluacion.get_escolaridad }}</td>
          </tr>
          <tr>
            <td>Localidad</td>
            <td>{{ evaluacion.localidad }}</td>
          </tr>
          <tr>
            <td>Número de Hijos</td>
            <td>{{ evaluacion.get_numero_hijos }}</td>
          </tr>
        </tbody>
      </table>
      <a href="/evaluaciones/e/{{ evaluacion.id }}/" class="btn btn-default btn-block">Editar</a>
    </div>
  </div>
</div>
<div class="panel panel-default">
  <div class="panel-heading">Competencias</div>
  <div class="panel-body">
      <table class="table">
        <tbody>
          {% for resultado in evaluacion.get_resultados %}
          <tr>
            <td><b>{{ resultado.competencia|title }}</b></td>
            <td class="{{ resultado.class }}">{{ resultado.total }}</td>
          </tr>
          {% endfor %}
        </tbody>
        <tfoot>
          <tr>
            <th>Total</th>
            <th>{{ evaluacion.get_calificacion.total }}</th>
          </tr>
          <tr class="{{ evaluacion.get_calificacion.class }}">
            <th>Nivel</th>
            <th>{{ evaluacion.get_calificacion.nivel }}</th>
          </tr>
        </tfoot>
      </table>
      <a href="/evaluaciones/e/{{ evaluacion.id }}/q/" class="btn btn-default btn-block">Cuestionario</a>
  </div>
</div>
<div class="panel panel-default">
  <div class="panel-heading">Resultados</div>
  <div class="panel-body">
    <canvas id="myChart"></canvas>
    <script charset="utf-8">
      var ctx = document.getElementById('myChart').getContext('2d');

      var r_lables = [];
      var r_data = [];
      var r_colors = [];

      {% for resultado in evaluacion.get_resultados %}
      r_lables.push('{{ resultado.competencia|title }}');
      r_data.push({{ resultado.total }});
      r_colors.push({% if resultado.class == 'success' %}'#d4edda'{% elif resultado.class == 'warning' %}'#fff3cd'{% else %}'#f8d7da'{% endif%});
      {% endfor %} 

      var myChart = new Chart(ctx, {
          type: 'horizontalBar',
          data: {
              labels: r_lables,
              datasets: [{
                  label: 'Totales',
                  data: r_data,
                  backgroundColor: r_colors
              }]
          },
          options: {
              scales: {
                  yAxes: [{
                      ticks: {
                          beginAtZero: true
                      }
                  }]
              }
          }
      });
    </script>
  </div>
</div>
<a href="/evaluaciones/" class="btn btn-default">Regresar</a>
{% endblock %}

